#!/bin/sh
set -eu

precommit() {
  cp -f $HOME/.dotfiles/linux/git/.pre-commit-config.yaml .
  pre-commit autoupdate
  pre-commit install --hook-type pre-commit --hook-type commit-msg --hook-type pre-push --allow-missing-config
}

# TODO: Check if .git folder/directory exists
initial() {
  git init
}

if [ "$1" = "initialize" ]; then
  echo "[dotfiles-git-repo] Initializing"
  initial
  exit 0
elif [ "$1" = "precommit" ]; then
  echo "[dotfiles-git-repo] Initializing"
  precommit
  exit 0
elif [ "$1" = "validate" ]; then
  echo "[dotfiles-git-repo] Under construction! Exiting..."
  exit 1
else
  echo "Usage: $0 {initialize|precommit|validate}"
  echo "  initialize: Initialize Git with pre-commit support."
  echo "  precommit: Initialize pre-commit support (without git init)."
  echo "  validate: Validates the repository if it's being initialized or not."
  exit 1
fi
